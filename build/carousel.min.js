"use strict";function _typeof(t){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(t,e,i){var s,r,a=this,o=[],n={},h=function(t){t.matches?l.each(o,function(e){e.hasMediaQueries()&&(s&&clearTimeout(s),r&&clearTimeout(r),s=setTimeout(function(){s=null,r=null,e.changeMedia(t.media)},5))}):s||(r&&clearTimeout(r),r=setTimeout(function(){l.each(o,function(t){t.hasMediaQueries()&&t.changeMedia()}),s=null,r=null},5))},c="ontouchstart"in t||i.maxTouchPoints>0||i.msMaxTouchPoints>0,l={getByClass:function(t,e,i){var s=t.getElementsByClassName(e);return i&&s.length?s[0]:s.length&&s||void 0},getByTag:function(t,e,i){var s=t.getElementsByTagName(e);return i&&s&&s.length?s[0]:s},mkel:function(t,i){var s=e.createElement(t);if(i)for(var r=Object.keys(i),a=0;a<r.length;a++)s.setAttribute(r[a],i[r[a]]);return s},each:function(t,e){for(var i=0;i<t.length&&!1!==e.call(a,t[i]);i++);},addMediaQuery:function(e){n[e]||(n[e]=!0,t.matchMedia(e).addListener(h))},setPercentTouchThreshold:function(e,i){var s=t.outerWidth,r=Math.abs(Math.round(s/(100/e)));i.touchthreshold=r},closest:function(t,e){if(t.closest)return t.closest(e);try{do{if(t=t.parentNode){var i=t.querySelector(e);if(i)return i}}while(t)}catch(t){return console.error(t),null}},debounce:function(t,e,i){var s;return function(){var r=this,a=arguments,o=function(){s=null,i||t.apply(r,a)},n=i&&!s;clearTimeout(s),s=setTimeout(o,e),n&&t.apply(this,a)}}},u=function e(i){var s=this;this.config={delay:8e3,transition:"slide",touchthreshold:80,swipeRubberBand:1};var r=i.dataset,a=this.config;o.push(this),this.element=i,this.useIndicators=void 0!==r.carouselIndicators,this.indicators=[],this.slider=l.getByClass(i,"carousel-slider",!0),this.items=[],this.ivalId=null,this.currPos=0,this._hasmedia=-1,this._percentTouchThreshold=0,this.wrapper=i.dataset.carouselWrapper,this.wrapper&&(this.wrapper=l.closest(i,this.wrapper)),this.staticTextElem=l.getByClass(i,"carousel-static-text",!0),c&&this.element.classList.add("carousel-is-touch");var n,h=l.getByClass(this.slider,"carousel-item"),u=0;if(l.each(h,function(t){s.items.push(new e.Item(t,u++,s))}),this.wrapper){for(var d=!1,m=0;m<this.items.length;m++)if(this.items[m].autoHeight){d=!0;break}d&&t.addEventListener("resize",l.debounce(function(){s.setAutoHeight()},100),!0)}r.carouselDelay&&(a.delay=parseInt(r.carouselDelay,10)),r.carouselTransition&&(a.transition=r.carouselTransition),c&&r.carouselTouchThreshold&&(n=r.carouselTouchThreshold,"%"===n[n.length-1]?(this._percentTouchThreshold=parseInt(n,10),l.setPercentTouchThreshold(this._percentTouchThreshold,a)):a.touchthreshold=parseInt(n,10)),r.carouselRubberbandSwipe&&(n=parseFloat(r.carouselRubberbandSwipe,10))>1&&(a.swipeRubberBand=n),this.items.length&&(this.items[0].load(),this.items[0].activate()),this.items.length>1&&(this.items[1].load(),this._makeIndicators()),c&&this._setupTouchEvents(),this.items.length>1&&this.play()};u.prototype.sliderAnimate=function(t){t?this.slider.classList.add("animate"):this.slider.classList.remove("animate")},u.prototype.currentItem=function(){return this.items[this.currPos]},u.prototype.play=function(){this.ivalId&&clearTimeout(this.ivalId);var t=this;this.ivalId=setTimeout(function(){t.next(),t.play()},this.config.delay)},u.prototype.pause=function(){clearTimeout(this.ivalId),this.sliderAnimate(!1)},u.prototype.next=function(){this.currPos+=1,this.currPos>=this.items.length&&(this.currPos=0),this.goto(this.currPos)},u.prototype.goto=function(t){t<0?t=this.items.length-1:t>=this.items.length&&(t=0);var e=t<this.currPos?t-1:t+1;clearTimeout(this.ivalId),this.sliderAnimate(!0),this._loadIfNecessary(t),this._loadIfNecessary(e),this.setIndicator(t),this.slider.dataset.carouselPos=t,this.currPos=t,this.items[t].activate(),this.play()},u.prototype.hasMediaQueries=function(){var t=this;return-1!==this._hasmedia?!!this._hasmedia:(l.each(this.items,function(e){if(e.hasMediaQueries)return t._hasmedia=1,!1}),-1===this._hasmedia&&(this._hasmedia=0),!!this._hasmedia)},u.prototype.changeMedia=function(t){this._percentTouchThreshold&&l.setPercentTouchThreshold(this._percentTouchThreshold,this.config),l.each(this.items,function(e){e.hasMediaQueries&&e.changeMedia(t)}),this.setAutoHeight()},u.prototype._loadIfNecessary=function(t){t>=0&&t<this.items.length&&(this.items[t].isLoaded||this.items[t].load())},u.prototype._setupTouchEvents=function(){var t,e=this,i={x:0,y:0,startX:0},s=this,r=function(t){return t.changedTouches[0]},a=function(t){i.x=t.clientX,i.y=t.clientY,i.startX=t.clientX},o=this.slider,n=!1;o.addEventListener("touchstart",function(i){t&&clearTimeout(t);var o=r(i);a(o),e.element.classList.add("carousel-is-touchdrag"),s.pause()},!1),o.addEventListener("touchend",function(e){if(t=setTimeout(function(){s.element.classList.remove("carousel-is-touchdrag")},1e3),n)return void(n=!1);var a=r(e),h=a.clientX-i.x;Math.abs(h)<s.config.touchthreshold&&(s.sliderAnimate(!0),requestAnimationFrame(function(){o.style.removeProperty("left")})),s.play()},!1),o.addEventListener("touchcancel",function(){s.element.classList.remove("carousel-is-touchdrag"),o.style.removeProperty("left"),s.play()},!1);var h=function t(e){var h=r(e),l=h.clientX-i.x,u=h.clientX-i.startX,d=o.offsetLeft;i.x=h.clientX;var m=d+l/(s.config.swipeRubberBand||1);if(Math.abs(u)>s.config.touchthreshold)return e.preventDefault(),n=!0,o.style.removeProperty("left"),o.removeEventListener("touchmove",t,!1),l>0?(s._loadIfNecessary(s.currPos-1),s.goto(s.currPos-1)):l<0&&(s._loadIfNecessary(s.currPos+1),s.goto(s.currPos+1)),setTimeout(function(){a(h),c()},600),!1;o.style.left=m+"px"},c=function(){o.addEventListener("touchmove",h,!1)};c()},u.prototype._makeIndicators=function(){var t=this;if(this.useIndicators&&!(this.items.length<2)){var e=l.getByClass(this.element,"carousel-indicators",!0),i=[];e||(e=l.mkel("div",{class:"carousel-indicators"})),this.items.forEach(function(){var s=new u.Indicator(t,i.length);e.appendChild(s.btn),i.push(s)}),i[0].activate(),this.element.appendChild(e),this.indicators=i}},u.prototype.setIndicator=function(t){!this.useIndicators||this.items.length<2||(void 0===t&&(t=this.currPos),this.currPos=t,this.indicators.forEach(function(t){t.deActivate()}),this.indicators[t].activate())},u.prototype.setAutoHeight=function(){var t=this;if(this.wrapper){var i=this.currentItem();if(i.autoHeight){var s=function(){var t=l.mkel("img",{src:i.img.src,width:i.img.width});t.style.visibility="hidden",t.style.position="absolute",e.body.appendChild(t);var s=t.height;return e.body.removeChild(t),s};!function e(){if(i.isLoaded){var r=s();t.wrapper.classList.add("carousel-auto-height"),t.wrapper.style.height=r+"px",t.wrapper.style.minHeight="0px"}else requestAnimationFrame(e)}()}else this.wrapper.classList.remove("carousel-auto-height"),this.wrapper.style.removeProperty("height"),this.wrapper.style.removeProperty("min-height")}},u.clickBack=null,u.Item=function(i,s,r){var a=this;if(this.mediaQueries={},this.hasMediaQueries=!1,this.img=l.getByTag(i,"img",!0),this.element=i,this.isLoaded=!1,this.src=null,this.credit=null,this.mediaSizes=null,this.href=i.dataset.carouselHref,this.position=s,this.hasImg=void 0===this.img.length,this.carousel=r,this.keepImg=void 0!==i.dataset.carouselKeepImg,this.autoHeight=void 0!==i.dataset.carouselAutoHeight,this.creditElem=l.mkel("div",{class:"carousel-photo-credit carousel-hidden"}),this.keepImg&&this.element.classList.add("carousel-item-keep-img"),this.element.setAttribute("data-carousel-position",s),this.element.appendChild(this.creditElem),this.href&&i.addEventListener("click",function(t){if(t.preventDefault(),"function"==typeof u.clickBack){if(!1===u.clickBack(a))return}e.location.href=a.href},!0),this.hasImg){this.defaultSrc=this.img.dataset.carouselSrc,this.defaultCred=this.img.dataset.carouselPhotoCredit,this._collectMediaSizes();for(var o,n=Object.keys(this.mediaQueries).sort(),h=0;h<n.length;h++)o=n[h],t.matchMedia(o).matches&&(this.src=this.mediaQueries[o],"object"===_typeof(this.src)&&(this.credit=this.src.credit,this.src=this.src.img));this.src||(this.src=this.defaultSrc),this.credit||(this.credit=this.defaultCred),this.keepImg||(this.img.style.display="none")}},u.Item.prototype.activate=function(){var t=this;this.carousel.setAutoHeight();var i=this.carousel.staticTextElem;if(i){var s=function(){e.location.href=t.href};i._cb&&i.removeEventListener("click",i._cb),this.href?(i.addEventListener("click",s,!1),i._cb=s,i.style.cursor="pointer"):i.style.cursor="default"}},u.Item.prototype.changeMedia=function(t){var e=this.mediaQueries[t]||this.defaultSrc;"object"===_typeof(e)?(this.src=e.img||this.defaultSrc,this.credit=e.credit||this.defaultCred):(this.src=e,this.credit=this.defaultCred),this.isLoaded&&this.load()},u.Item.prototype._collectMediaSizes=function(){var t,e=[],i={},s={};for(var r in this.img.dataset)t=r.match(/(?:carousel)Mq-(\d+)$/),t?(this.hasMediaQueries=!0,t=parseInt(t[1],10),e.push(t),i[t]=this.img.dataset[r]):(t=r.match(/(?:carouselPhotoCredit)Mq-(\d+)$/))&&(t=parseInt(t[1],10),s[t]=this.img.dataset[r]);var a=e.length;if(a){var o,n,h;e.sort();for(var c=0;c<a;c++)o=e[c],n="(min-width: ".concat(o+1,"px)"),c+1<e.length&&(n="(max-width: ".concat(e[c+1],"px) and ")+n),h=i[o],s[o]&&(h={img:h,credit:s[o]}),this.mediaQueries[n]=h,l.addMediaQuery(n);this.mediaSizes=e}},u.Item.prototype.load=function(){this.hasImg&&this._setSrc(this.src)},u.Item.prototype._setSrc=function(t){var e=this;if(this.hasImg){this.isLoaded=!1;var i=t;"object"===_typeof(t)&&(i=t.img),this.img.setAttribute("src",i),this.img.onload=function(){e.keepImg||(e.element.style.backgroundImage="url(".concat(i,")")),e.isLoaded=!0},this.credit?(this.creditElem.textContent=this.credit,this.creditElem.classList.remove("carousel-hidden")):(this.creditElem.textContent="",this.creditElem.classList.add("carousel-hidden"))}},u.Indicator=function(t,e){var i=this;this.index=e,this.owner=t,this.btn=l.mkel("a",{class:"carousel-indicator",href:"#carousel-"+e}),this.btn.appendChild(l.mkel("span",{class:"carousel-indicator-inner"})),this.btn.addEventListener("click",function(t){return t.preventDefault(),i.owner.goto(i.index),!1},!0)},u.Indicator.prototype.activate=function(){this.btn.classList.add("carousel-indicator-active")},u.Indicator.prototype.deActivate=function(){this.btn.classList.remove("carousel-indicator-active")},t.addEventListener("DOMContentLoaded",function(){var t=l.getByClass(e,"carousel");t&&t.length&&l.each(t,function(t){new u(t)})}),u.carousels=o,t.Carousel=u}(window,document,window.navigator);
//# sourceMappingURL=carousel.min.js.map
